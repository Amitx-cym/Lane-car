<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Car Game</title>
<style>
  body, html {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #333;
  }
  canvas {
    display: block;
  }
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    font-size: 24px;
    font-family: sans-serif;
    z-index: 10;
  }
  #restartBtn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 15px 30px;
    font-size: 24px;
    background: rgba(255,255,255,0.8);
    border: none;
    border-radius: 10px;
    cursor: pointer;
    display: none;
    z-index: 10;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="score">Score: 0</div>
<button id="restartBtn">Restart</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

const laneCount = 5;
let laneWidth = canvas.width / laneCount;

const playerImg = new Image();
playerImg.src = "player.png"; // your player car PNG

const obstacleImgs = ["red.png","green.png","yellow.png"].map(src=>{
  let img = new Image();
  img.src = src; // your enemy car PNGs
  return img;
});

let player = {
  lane: 2,
  y: canvas.height - 150,
  width: laneWidth * 0.6,
  height: 100,
};

let obstacles = [];
let obstacleSpeed = 7;
let spawnTimer = 0;
let score = 0;
let gameOver = false;

const restartBtn = document.getElementById("restartBtn");
const scoreDiv = document.getElementById("score");

// PC Controls
document.addEventListener("keydown", e=>{
  if(e.key === "ArrowLeft" && player.lane>0) player.lane--;
  if(e.key === "ArrowRight" && player.lane<laneCount-1) player.lane++;
});

// Mobile Touch & Drag Controls
let startX = null;

canvas.addEventListener("touchstart", e => {
  startX = e.touches[0].clientX;
});

canvas.addEventListener("touchmove", e => {
  if (!startX) return;
  let touchX = e.touches[0].clientX;
  let delta = touchX - startX;

  if (delta > 30 && player.lane < laneCount - 1) { // swipe right
    player.lane++;
    startX = touchX;
  } else if (delta < -30 && player.lane > 0) { // swipe left
    player.lane--;
    startX = touchX;
  }
});

canvas.addEventListener("touchend", e => {
  startX = null;
});

// Game loop
function gameLoop(){
  if(gameOver) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  laneWidth = canvas.width / laneCount;

  // Draw lanes
  ctx.strokeStyle = "white";
  ctx.lineWidth = 4;
  ctx.setLineDash([20, 20]);
  for(let i=1;i<laneCount;i++){
    ctx.beginPath();
    ctx.moveTo(i*laneWidth,0);
    ctx.lineTo(i*laneWidth,canvas.height);
    ctx.stroke();
  }
  ctx.setLineDash([]);

  // Draw player
  ctx.drawImage(playerImg, player.lane*laneWidth + laneWidth*0.2, player.y, player.width, player.height);

  // Spawn obstacles randomly
  spawnTimer--;
  if(spawnTimer <=0){
    spawnTimer = Math.floor(Math.random()*40)+20;
    let lanesAvailable = [...Array(laneCount).keys()];
    let laneIndex = lanesAvailable[Math.floor(Math.random()*lanesAvailable.length)];
    obstacles.push({
      lane: laneIndex,
      y: -120,
      width: laneWidth * 0.6,
      height: 100,
      img: obstacleImgs[Math.floor(Math.random()*obstacleImgs.length)]
    });
  }

  // Move and draw obstacles
  for(let i=obstacles.length-1;i>=0;i--){
    let obs = obstacles[i];
    obs.y += obstacleSpeed;
    ctx.drawImage(obs.img, obs.lane*laneWidth + laneWidth*0.2, obs.y, obs.width, obs.height);

    // Collision
    if(obs.y + obs.height > player.y && obs.y < player.y + player.height && obs.lane === player.lane){
      gameOver = true;
      restartBtn.style.display = "block";
    }

    // Remove off-screen obstacles
    if(obs.y > canvas.height) obstacles.splice(i,1);
  }

  // Update score
  score++;
  scoreDiv.textContent = "Score: " + score;

  requestAnimationFrame(gameLoop);
}

// Restart game
restartBtn.addEventListener("click", ()=>{
  gameOver = false;
  obstacles = [];
  score = 0;
  player.lane = 2;
  restartBtn.style.display = "none";
  gameLoop();
});

// Start game
gameLoop();
</script>
</body>
</html>
